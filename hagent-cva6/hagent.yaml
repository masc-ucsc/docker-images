profiles:
  - name: spec
    description: "Generate specification from CVA6 RTL using run_spec_builder.py"
    memory: 8
    configuration:
      # track_repo_dir is relative to /code/workspace/repo
      source: "track_repo_dir('core', ext='.sv')"
      # track_build_dir is relative to /code/workspace/build
      output: "track_build_dir('outputs', ext='')"
      environment: # Will inherit docker image, so no need to reset CVA6_HOME
        SLANG_BIN: "/mnt/slang/build/bin/slang"
    apis:
      - name: spec_builder
        description: "Run spec builder for CVA6 load_store_unit"
        command: >
          bash -lc '
            poetry run python hagent/step/sva_gen/run_spec_builder.py \
              --mode single \
              --slang ${SLANG_BIN} \
              --llm-conf hagent/step/sva_gen/spec_prompt.yaml \
              --include $HAGENT_REPO_DIR/core/include \
              --rtl $HAGENT_REPO_DIR/core \
              --top load_store_unit
          '

#docker run --rm -it \
#  -v <path>/spec_gen:/mnt/spec_gen \
#  -e SLANG_BIN=/mnt/slang/build/bin/slang \
#  mascucsc/hagent-cva6:latest

